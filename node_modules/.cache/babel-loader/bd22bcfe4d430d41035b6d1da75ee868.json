{"ast":null,"code":"var _jsxFileName = \"/Users/liam/react-moonland/src/App.js\";\nimport styles from './App.css';\nimport React, { useState, useEffect } from \"react\";\nimport Unity, { UnityContext } from \"react-unity-webgl\";\nimport * as solanaWeb3 from '@solana/web3.js';\nimport parse from 'html-react-parser';\nimport background from \"./background.png\";\nimport ProgressBar from 'react-bootstrap/Button';\nimport reactDom from 'react-dom';\nimport axios from \"axios\";\nimport { Connection, clusterApiUrl, LAMPORTS_PER_SOL } from \"@solana/web3.js\";\nimport { getParsedNftAccountsByOwner, isValidSolanaAddress, createConnectionConfig } from \"@nfteyez/sol-rayz\";\nimport './App.css';\nconst unityContext = new UnityContext({\n  loaderUrl: \"./Build/public.loader.js\",\n  dataUrl: \"./Build/public.data\",\n  frameworkUrl: \"./Build/public.framework.js\",\n  codeUrl: \"./Build/public.wasm\"\n});\n\nfunction App() {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [progression, setProgression] = useState(0);\n  const [provider, setProvider] = useState(\"\"); //check solana on window. This is useful to fetch address of your wallet.\n\n  const getProvider = async () => {\n    if (\"solana\" in window) {\n      const provider = window.solana;\n\n      if (provider.isPhantom) {\n        console.log(\"And our public key is?  \", provider.publicKey.toString());\n        console.log(\"Is Phantom installed?  \", provider.isPhantom);\n        console.log(\"Are we connected?  \", window.solana.isConnected);\n        return provider;\n      }\n    }\n  }; // const getProvider = async () => {\n  //   if (\"solana\" in window) {\n  //     await window.solana.connect(); // opens wallet to connect to\n  //     const provider = window.solana;\n  //     if (provider.isPhantom) {\n  //       console.log(\"Is Phantom installed?  \", provider.isPhantom);\n  //       return provider;\n  //     }\n  //   } else {\n  //     window.alert('Install https://www.phantom.app/');\n  //   }\n  // };\n\n\n  var publicKey;\n  var allNftData; // window.onload = () => {\n  //   getProvider().then(provider => {\n  //     console.log('key', provider.publicKey.toString());\n  //     publicKey = provider.publicKey.toString();\n  //     setProvider(provider.publicKey.toString());\n  //   })\n  //   .catch(function(error){\n  //     console.log(error)\n  //   });\n  // }\n  //create a connection\n\n  const createConnection = () => {\n    return new Connection(clusterApiUrl(\"devnet\")); // return new Connection(clusterApiUrl(\"mainnet-beta\"));\n  }; //get NFT\n\n\n  const getAllNftData = async () => {\n    try {\n      // const connect =  createConnectionConfig(clusterApiUrl(\"mainnet-beta\"));\n      const connect = createConnectionConfig(clusterApiUrl(\"devnet\"));\n      const provider = getProvider(); // let ownerToken = \"8BnpSSotP9TW5jc1ExASvYhfcv196tH3VAAT1ewnNYJi\"\n\n      console.log(\"THE KEY IS:\" + provider.publicKey);\n      let ownerToken = provider.publicKey;\n      const result = isValidSolanaAddress(ownerToken);\n      console.log(\"result\", result);\n      const nfts = await getParsedNftAccountsByOwner({\n        publicAddress: ownerToken,\n        connection: connect,\n        serialization: true\n      });\n      return nfts;\n    } catch (error) {\n      console.log(error);\n    }\n  }; //Function to get all nft data\n\n\n  const getNftTokenData = async () => {\n    try {\n      let nftData = await getAllNftData();\n      var data = Object.keys(nftData).map(key => nftData[key]);\n      let arr = [];\n      let n = data.length;\n\n      for (let i = 0; i < n; i++) {\n        console.log(data[i].data.uri);\n        let val = await axios.get(data[i].data.uri);\n        arr.push(val);\n        console.log(val.data.image);\n      }\n\n      allNftData = arr;\n      return arr;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const NFT = async props => {\n    const [nftData, setNftData] = useState([]);\n    const [loading, setLoading] = useState(false);\n    createConnection();\n    getProvider();\n    useEffect(() => {\n      async function data() {\n        let res = await getAllNftData();\n        setNftData(res);\n        setLoading(true);\n        getNftTokenData();\n      }\n\n      data();\n    }, []);\n  };\n\n  useEffect(() => {\n    setProvider(publicKey);\n  }, []);\n  useEffect(() => {\n    setProvider(publicKey);\n  }, []);\n  useEffect(function () {\n    unityContext.on(\"GetWallet\", function () {\n      if (window.solana.isConnected) {\n        console.log(window.solana.publicKey.toString());\n        console.log(provider.publicKey);\n        console.log(allNftData);\n        unityContext.send(\"Wallet\", \"SetWallet\", allNftData);\n      } else {\n        window.alert(\"Pleas Connect your Wallet or play like a guest\");\n      }\n    });\n  }, []);\n  useEffect(function () {\n    unityContext.on(\"progress\", function (progression) {\n      setProgression(progression);\n    });\n  }, []);\n  useEffect(function () {\n    unityContext.on(\"loaded\", function () {\n      setIsLoaded(true);\n    });\n  }, []);\n\n  const getConnect = async () => {\n    if (\"solana\" in window) {\n      if (!window.solana.isConnected) {\n        await window.solana.connect();\n      }\n\n      const provider = window.solana;\n\n      if (provider.isPhantom) {\n        console.log(\"And our public key is?  \", provider.publicKey.toString());\n        console.log(\"Is Phantom installed?  \", provider.isPhantom);\n        console.log(\"Are we connected?  \", window.solana.isConnected);\n        return provider;\n      }\n    } else {\n      window.alert('Install https://www.phantom.app/');\n    }\n  };\n\n  setTimeout(function () {\n    getProvider(); // getConnect();\n  }, 5000); // NFT();\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      visibility: isLoaded ? \"hidden\" : \"visible\",\n      backgroundImage: `url(${background})`,\n      backgroundSize: \"cover\",\n      height: \"100%\",\n      width: \"100%\",\n      color: \"#f5f5f5\",\n      position: 'absolute',\n      left: 0,\n      top: 0\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(ProgressBar, {\n    variant: \"success\",\n    now: progression * 100,\n    style: {\n      visibility: isLoaded ? \"hidden\" : \"visible\",\n      height: \"10px\",\n      width: \"100%\",\n      position: \"absolute\",\n      bottom: 0,\n      color: \"red\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 3\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      visibility: isLoaded ? \"hidden\" : \"visible\",\n      height: \"30px\",\n      width: \"100%\",\n      position: \"absolute\",\n      textAlign: 'center',\n      bottom: \"100px\",\n      fontSize: \"2em\",\n      fontColor: \"red\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 4\n    }\n  }, \"help me...\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Unity, {\n    style: {\n      visibility: isLoaded ? \"visible\" : \"hidden\",\n      height: \"100%\",\n      width: \"100%\",\n      background: \"grey\",\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      overflow: \"hidden\"\n    },\n    unityContext: unityContext,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 4\n    }\n  })));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/liam/react-moonland/src/App.js"],"names":["styles","React","useState","useEffect","Unity","UnityContext","solanaWeb3","parse","background","ProgressBar","reactDom","axios","Connection","clusterApiUrl","LAMPORTS_PER_SOL","getParsedNftAccountsByOwner","isValidSolanaAddress","createConnectionConfig","unityContext","loaderUrl","dataUrl","frameworkUrl","codeUrl","App","isLoaded","setIsLoaded","progression","setProgression","provider","setProvider","getProvider","window","solana","isPhantom","console","log","publicKey","toString","isConnected","allNftData","createConnection","getAllNftData","connect","ownerToken","result","nfts","publicAddress","connection","serialization","error","getNftTokenData","nftData","data","Object","keys","map","key","arr","n","length","i","uri","val","get","push","image","NFT","props","setNftData","loading","setLoading","res","on","send","alert","getConnect","setTimeout","visibility","backgroundImage","backgroundSize","height","width","color","position","left","top","bottom","textAlign","fontSize","fontColor","overflow"],"mappings":"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","sourcesContent":["import styles from './App.css';\nimport React, {useState, useEffect } from \"react\";\nimport Unity, { UnityContext } from \"react-unity-webgl\";\nimport * as solanaWeb3 from '@solana/web3.js';\nimport parse from 'html-react-parser';\nimport background from \"./background.png\";\nimport ProgressBar from 'react-bootstrap/Button';\nimport reactDom from 'react-dom';\nimport axios from \"axios\";\nimport { Connection, clusterApiUrl, LAMPORTS_PER_SOL } from \"@solana/web3.js\";\nimport { getParsedNftAccountsByOwner,isValidSolanaAddress, createConnectionConfig,} from \"@nfteyez/sol-rayz\";\nimport './App.css';\n\nconst unityContext = new UnityContext({\n  loaderUrl: \"./Build/public.loader.js\",\n  dataUrl: \"./Build/public.data\",\n  frameworkUrl: \"./Build/public.framework.js\",\n  codeUrl: \"./Build/public.wasm\"\n});\n\nfunction App() {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [progression, setProgression] = useState(0);\n  const [provider, setProvider] = useState(\"\");\n\n//check solana on window. This is useful to fetch address of your wallet.\nconst getProvider = async () => {\n  if (\"solana\" in window) {\n    const provider = window.solana;\n    if (provider.isPhantom) {\n      console.log(\"And our public key is?  \", provider.publicKey.toString());\n      console.log(\"Is Phantom installed?  \", provider.isPhantom);\n      console.log(\"Are we connected?  \", window.solana.isConnected);\n      return provider;\n    }\n  }\n};\n\n  // const getProvider = async () => {\n  //   if (\"solana\" in window) {\n  //     await window.solana.connect(); // opens wallet to connect to\n  //     const provider = window.solana;\n  //     if (provider.isPhantom) {\n  //       console.log(\"Is Phantom installed?  \", provider.isPhantom);\n  //       return provider;\n  //     }\n  //   } else {\n  //     window.alert('Install https://www.phantom.app/');\n  //   }\n  // };\n  \n  var publicKey;\n  var allNftData;\n  \n  // window.onload = () => {\n  //   getProvider().then(provider => {\n  //     console.log('key', provider.publicKey.toString());\n  //     publicKey = provider.publicKey.toString();\n  //     setProvider(provider.publicKey.toString());\n  //   })\n  //   .catch(function(error){\n  //     console.log(error)\n  //   });\n  \n  // }\n\n  //create a connection\nconst createConnection = () => {\n  return new Connection(clusterApiUrl(\"devnet\"));\n  // return new Connection(clusterApiUrl(\"mainnet-beta\"));\n};\n\n  //get NFT\n  const getAllNftData = async () => {\n    try {\n      // const connect =  createConnectionConfig(clusterApiUrl(\"mainnet-beta\"));\n      const connect =  createConnectionConfig(clusterApiUrl(\"devnet\"));\n      const provider = getProvider();\n      // let ownerToken = \"8BnpSSotP9TW5jc1ExASvYhfcv196tH3VAAT1ewnNYJi\"\n      console.log(\"THE KEY IS:\" + provider.publicKey);\n      let ownerToken = provider.publicKey;\n      const result = isValidSolanaAddress(ownerToken);\n      console.log(\"result\", result);\n      const nfts = await getParsedNftAccountsByOwner({\n        publicAddress: ownerToken,\n        connection: connect,\n        serialization: true,\n      });\n      return nfts;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\n//Function to get all nft data\nconst getNftTokenData = async () => {\n  try {\n    let nftData = await getAllNftData();\n    var data = Object.keys(nftData).map((key) => nftData[key]);                                                                    let arr = [];\n    let n = data.length;\n    for (let i = 0; i < n; i++) {\n      console.log(data[i].data.uri);\n      let val = await axios.get(data[i].data.uri);\n      arr.push(val);\n      console.log(val.data.image);\n    }\n    allNftData = arr;\n    return arr;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nconst NFT = async (props) => {\n  const [nftData, setNftData] = useState([]);\n  const [loading, setLoading] = useState(false);\n  createConnection();\n  getProvider();\nuseEffect(() => {\n    async function data() {\n      let res = await getAllNftData();\n      setNftData(res);\n      setLoading(true);\n      getNftTokenData();\n    }\n    data();\n  }, []);\n}\n  \n  useEffect( () => {\n   setProvider(publicKey);\n  }, []);\n  useEffect( () => {\n    setProvider(publicKey);\n   }, []);\n\n   useEffect(function () {    \n    unityContext.on(\"GetWallet\", function () {\n      if (window.solana.isConnected) {\n        console.log(window.solana.publicKey.toString());\n        console.log(provider.publicKey);\n        console.log(allNftData);\n        unityContext.send(\"Wallet\", \"SetWallet\", allNftData);\n      } else {\n        window.alert(\"Pleas Connect your Wallet or play like a guest\");\n      }\n    });\n  }, []);\n\n\n  useEffect(function () {\n    unityContext.on(\"progress\", function (progression) {\n      setProgression(progression);\n    });\n  }, []);\n\n\n  useEffect(function () {\n    unityContext.on(\"loaded\", function () {\n      setIsLoaded(true);\n    });\n  }, []);\n \n  const getConnect = async () => {\n    if (\"solana\" in window) {\n      if (!window.solana.isConnected) {\n        await window.solana.connect();\n      }\n      const provider = window.solana;\n      if (provider.isPhantom) {\n        console.log(\"And our public key is?  \", provider.publicKey.toString());\n        console.log(\"Is Phantom installed?  \", provider.isPhantom);\n        console.log(\"Are we connected?  \", window.solana.isConnected);\n        return provider;\n      }\n    } else {\n      window.alert('Install https://www.phantom.app/');\n  }\n};\n\n\n\nsetTimeout(function () {\n  getProvider();\n  // getConnect();\n}, 5000);\n\n// NFT();\n\n  return (\n\n  <div style = {{\n    visibility: isLoaded ? \"hidden\" : \"visible\",\n    backgroundImage: `url(${background})`,\n      backgroundSize: \"cover\",\n      height: \"100%\",\n      width: \"100%\",\n      color: \"#f5f5f5\",\n    position: 'absolute',\n    left: 0,\n    top: 0,\n\n    \n  }}>\n   <div>\n  <ProgressBar variant=\"success\" now={progression * 100}\n  style={{ visibility: isLoaded ? \"hidden\" : \"visible\",\n  height: \"10px\",\n  width: \"100%\",\n  position: \"absolute\",\n  bottom: 0,\n  color: \"red\",\n  }}\n  \n  />\n  \n    </div>\n    \n   <p\n    style={{ visibility: isLoaded ? \"hidden\" : \"visible\",\n    height: \"30px\",\n    width: \"100%\",\n    position: \"absolute\",\n    textAlign: 'center',\n    bottom: \"100px\",\n    fontSize: \"2em\",\n    fontColor: \"red\",\n\n    \n \n    }}>help me...</p>\n   \n   <div>\n   <Unity\n      style={{ visibility: isLoaded ? \"visible\" : \"hidden\",\n        height: \"100%\",\n        width: \"100%\",\n        background: \"grey\",\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        overflow: \"hidden\",\n     \n    }}\n      unityContext={unityContext}\n    />\n    </div>\n    </div>\n  );\n\n  }\n  \nexport default App"]},"metadata":{},"sourceType":"module"}